[[{"l":"\uD83C\uDFE2 OfficeSpaceManager","p":["\uD83C\uDFD7️ Purpose","\uD83D\uDCC1 Folder Structure","\uD83D\uDCD8 License & Credits","\uD83D\uDD01 Backup & Restore","\uD83D\uDD10 Data Safety","\uD83D\uDD17 Useful Microsoft Docs","\uD83D\uDD27 Requirements","\uD83D\uDD27 TODO","\uD83E\uDDE0 Usage","\uD83E\uDDEA Running Tests","\uD83D\uDE4B Support","\uD83D\uDE80 Features","\uD83D\uDEE1 Design Philosophy","A modular PowerShell CLI toolkit to establish a simple, and logical workflow from a single place to establish and manage Microsoft Places, Exchange Room Resources, and Metadata across Microsoft 365 environments.","PowerShell 7+ Build Status Test Coverage","This repository is still under major initial development, and should be considered 'Extreme Alpha'. Any use of this repository is at your own risk knowing there will be continued and ongoing changes underway."]},{"l":"\uD83C\uDFD7️ Purpose","p":["This script is intended to help someone either setup, or manage, a Microsoft Exchange and Teams environment to:","Removes the need to navigate across multiple Admin applications, scripts, blades, etc to setup and maintain","Initial configuration (right settings configured so you can do this)","Bulk upload and maintenance (by way of .csv file) of sites, buildings, floors, desk groups and desks","Manage the bookable desk lifecycle (create, manage, rename, reassign, end of life)","Ensure consistency of naming conventions for desks","Provide disaster recovery for your environment, keeping offline backups of the environment for ease of restoration if and when needed","Offline storage of data to increase speed of action","Make your job as a Microsoft Modern Workplace analyist/engineer several times easier","A more detailed explaination to the working approach for this project can be found in IDEA and SPECIFICATION."]},{"l":"\uD83D\uDEE1 Design Philosophy","p":["See Design Philosophy."]},{"l":"\uD83D\uDE80 Features","p":["✅ All cmdlets and scripts use approved PowerShell verbs for discoverability and linter compliance.","✅ All connection routines are robust, session-reusing, and provide clear diagnostic output for Exchange, Teams, and Places.","✅ Auto-discovery of domains + validation of Exchange & Places configurations to support","✅ Automated first-time tenant setup (robustly enforced at launch)","✅ Backup and restore features, to enable complete download and upload of your configuration","✅ CSV template export/import for bulk editing of sites, buildings, floors, desks, desk pools, etc.","✅ Exchange Online + Microsoft Graph Places + Microsoft Teams integration","✅ Interactive CLI with modular submenus","✅ Logging, draft recovery, and error handling","✅ Metadata and site structure management, and local caching of information for speed","✅ Proactive Exchange Online connection and first-time setup enforcement","✅ Project is fully linted with PSScriptAnalyzer; all code changes validated for compliance.","✅ Resource provisioning (Desk / Room / Equipment)","✅ Robust error handling and user acknowledgement for all critical failures","✅ Simulation test suite with cleanup tools","✅ Uses native functions within existing PowerShell modules wherever possible","✅ Verbose session logging and input capture via -LogVerbose flag","For full list, see Features."]},{"l":"\uD83D\uDD27 Requirements","p":["See Requirements."]},{"l":"\uD83E\uDDE0 Usage","p":["Clone the repo:","Open PowerShell 7+","Navigate to the folder","Run:","The optional -LogVerbose flag enables full session transcript and input logging to Logs/TerminalVerbose.","On first run, you will be guided through robust first-time setup and Exchange Online connection. All errors require user acknowledgement and are logged."]},{"l":"\uD83D\uDCC1 Folder Structure","p":["WARNING: Due to continued development, this is subject to change.","See Folder Structure."]},{"l":"\uD83E\uDDEA Running Tests","p":["See Running Tests."]},{"l":"\uD83D\uDD01 Backup & Restore","p":["For more infomation, see Running Tests."]},{"l":"\uD83D\uDD17 Useful Microsoft Docs","p":["Microsoft Places Overview","Microsoft Graph Places API","Exchange Room Mailbox Docs","Set-CalendarProcessing"]},{"l":"\uD83D\uDE4B Support","p":["See Support."]},{"l":"\uD83D\uDD10 Data Safety","p":["See Data Safety"]},{"l":"\uD83D\uDD27 TODO","p":["See TODO and Known Issues."]},{"l":"\uD83D\uDCD8 License & Credits","p":["OfficeSpaceManager – Internal Admin Toolkit© 2025 – Michael Harris. Use it well. Built with PowerShell for Microsoft 365 tenants","See LICENSE for further information."]}],[{"l":"Retype Documentation Management Instructions for Copilot"},{"l":"1. Retype Project Setup","p":["The documentation site is managed using Retype.","Source content lives in the .website/ folder. Never edit files in docs/ directly; always update .website/ and run retype build to regenerate the site.","The root of the project contains retype.yml for configuration. Reference Retype configuration docs for options.","To build the site, run:","Output will be in the docs/ folder."]},{"l":"2. Website Structure & Content","p":[".website/ is organised by topic:","project-overview/(idea.md, specification.md, folder-structure.md, design-philosophy.md)","user-guides/(getting-started.md, backup-and-restore.md, testing.md, menu-structure.md)","issues/(knownissues.md, todo.md)","contributing/(CONTRIBUTING.md)","code/(MODULES.md, API docs)","support/(support.md, contact.md)","buy-me-a-kofi/(optional)","index.md(project landing page)","LICENSE.md (project license)","Each folder/file may include an index.yml to control navigation order."]},{"l":"3. Document Creation & Editing","p":["Create new documentation by adding Markdown files to the appropriate .website/ subfolder.","Use EN-AU spelling, accessible language, and inclusive formatting.","Start each Markdown file with !-- omit from toc -- unless otherwise required.","Use proper Markdown headings, lists, code blocks, and tables for structure and clarity.","Use relative links for internal references.","Update navigation/index files ( index.yml) as needed to maintain order."]},{"l":"4. Using Snippets for Retype Content","p":["Use VS Code snippets to quickly insert Retype-specific blocks, callouts, embeds, panels, tabs, and reference links.","Example snippet usage:","Type the prefix (e.g., retype-tab-block) and press Tab or Ctrl+Space to insert a formatted block.","Common Retype snippets (see your retype.code-snippets file for full list):","retype-page: Insert a page block with label, layout, order, visibility, and category.","retype-yml: Insert a YML order block.","retype-callout-*: Insert callout blocks (base, primary, tip, danger, etc.).","retype-embed: Insert embed blocks for links or YouTube.","retype-image: Insert image blocks with title, path, and alt text.","retype-panel: Insert multi-panel blocks.","retype-ref-link: Insert reference links.","retype-tab-block: Insert tabbed content blocks."]},{"l":"5. Building & Publishing the Site","p":["After editing or adding documentation, run retype build to regenerate the site.","Review the output in the docs/ folder.","Commit and push changes to the repository to update the published site (if using GitHub Pages or similar)."]},{"l":"6. Best Practices","p":["Always keep .website/ and root documentation in sync.","Use snippets to maintain consistent formatting and speed up authoring.","Regularly review for accessibility, inclusive language, and EN-AU spelling.","Update retype.yml and navigation files as the site evolves.","Document any custom Retype configurations or themes in README.md or CONTRIBUTING.md."]},{"l":"7. Troubleshooting","p":["If snippets do not appear, check VS Code language mode and snippet file syntax.","If the site does not build, review retype.yml and Markdown formatting for errors.","For advanced configuration, refer to Retype documentation.","Reference:","Retype Documentation","[OfficeSpaceManager CommonInstructions](see your project for details)","Your current VS Code snippets in retype.code-snippets"]}],[{"l":"Retype VS Code Snippet Expansion Draft (with Documentation Links)","p":["This document proposes new and improved VS Code snippets for Retype documentation authoring, with inline comments referencing the relevant Retype documentation for each option. All snippets are formatted for direct use in your .code-snippets file."]},{"l":"Retype Page Front Matter"},{"l":"Retype Folder Front Matter"},{"l":"Retype Callout Block"},{"l":"Retype Tabs Block"},{"l":"Retype Panel Block"},{"l":"Retype Embed Block"},{"l":"Retype Reference Link"},{"l":"Retype Image Block"},{"l":"GitHub Markdown Callout"},{"l":"Retype Table Block"},{"l":"Retype Footnote"},{"l":"Retype Definition List"},{"l":"Retype Task List"},{"l":"Retype Horizontal Rule"},{"l":"Retype Code Block","p":["Reference:","Retype Documentation"]}],[{"l":"TESTPLAN"},{"l":"Invoke-MainMenu.ps1","p":["// TESTING: Invoke-MainMenu.ps1// [X] TESTING: Main CLI entry point launches and displays menu// [X] TESTING: -LogVerbose flag enables transcript and input logging// [] TESTING: First-time setup enforced on first run// [] TESTING: Exchange Online connection required and validated"]},{"l":"Backups","p":["// TESTING: Backups// [] TESTING: Save-MetadataSnapshot.ps1 creates valid metadata backup// [] TESTING: Restore-MetadataSnapshot.ps1 restores backup correctly// [] TESTING: Backups/ConfigBackups/ and Backups/Snapshots/ are populated and managed"]},{"l":"CLI","p":["// TESTING: CLI// [] TESTING: ConfigurationMenu.ps1 launches and updates config// [] TESTING: LogsMenu.ps1 displays and manages logs// [] TESTING: ManageResourcesMenu.ps1 manages resources as expected// [] TESTING: OrphanMetadatamenu.ps1 identifies and manages orphaned metadata// [] TESTING: Wizards/ interactive flows function correctly"]},{"l":"config","p":["// TESTING: config// [] TESTING: FirstRunComplete.json is set after first run// [] TESTING: TenantConfig.json is loaded and validated"]},{"l":"Configuration","p":["// TESTING: Configuration// [] TESTING: Create-ConfigBackup.ps1 creates config backup ZIP// [] TESTING: Enable-PlacesFeatures.ps1 enables Places features// [] TESTING: Restore-ConfigBackup.ps1 restores config from backup// [] TESTING: Run-FirstTimeSetup.ps1 completes setup// [] TESTING: Validate-ExchangeSetup.ps1 validates Exchange setup// [] TESTING: Validate-PlacesFeatures.ps1 validates Places/Teams setup"]},{"l":"EnvironmentSetup","p":["// TESTING: EnvironmentSetup// [] TESTING: Ensure-CalendarProcessingSettings.ps1 applies correct settings// [] TESTING: Pin-PlacesAppInTeams.ps1 pins app in Teams// [] TESTING: Update-MailboxTypes.ps1 updates mailbox types"]},{"l":"Logs","p":["// TESTING: Logs// [] TESTING: Log files are created and rotated// [] TESTING: Clear-LogHistory.ps1 clears logs// [] TESTING: Compress-Logs.ps1 compresses logs// [] TESTING: Export-ActionHistory.ps1 exports action history// [] TESTING: View-LogHistory.ps1 displays logs"]},{"l":"Metadata","p":["// TESTING: Metadata// [] TESTING: .lastSync.json is updated after sync// [] TESTING: CachedResources.json is updated and valid"]},{"l":"Modules","p":["// TESTING: Modules// [] TESTING: CLI/ menu rendering and user interaction logic// [] TESTING: Configuration/ import/export, backup/restore, validation// [] TESTING: Logging/ centralised logging and error handling// [] TESTING: Reporting/ summary generation// [] TESTING: SiteManagement/ site/building/floor/desk management// [] TESTING: UserManagement/ user and permissions logic// [] TESTING: Utilities/ helper and utility functions"]},{"l":"OrphanFixer","p":["// TESTING: OrphanFixer// [] TESTING: Detect-NonStandardResources.ps1 detects non-standard resources// [] TESTING: Find-OrphanedResources.ps1 finds orphaned resources// [] TESTING: Fix-OrphanedResources.ps1 remediates orphaned resources// [] TESTING: Suggest-RenameResource.ps1 suggests resource renames// [] TESTING: Validate-DeskPoolMappings.ps1 validates desk pool mappings"]},{"l":"SiteManagement","p":["// TESTING: SiteManagement// [] TESTING: Export-SiteStructureTemplates.ps1 exports templates// [] TESTING: Import-SiteStructureFromCSV.ps1 imports from CSV// [] TESTING: Get-SiteStructure.ps1 retrieves site structure// [] TESTING: Sync-MetadataToCloud.ps1 syncs metadata to cloud"]},{"l":"TemplateManagement","p":["// TESTING: TemplateManagement// [] TESTING: Export-AllTemplates.ps1 exports all templates// [] TESTING: Export-MetadataTemplates.ps1 exports metadata templates// [] TESTING: Import-FromCSV.ps1 imports from CSV// [] TESTING: Import-MetadataFromCSV.ps1 imports metadata from CSV// [] TESTING: Validate-CSVImport.ps1 validates CSV import"]},{"l":"Tests","p":["// TESTING: Tests// [] TESTING: Unit and integration tests exist and pass"]},{"l":"TestSuite","p":["// TESTING: TestSuite// [] TESTING: Cleanup-TestResources.ps1 removes test resources// [] TESTING: Run-BookingSimulation.ps1 simulates booking scenarios// [] TESTING: Run-TestSuite.ps1 runs all tests// [] TESTING: Simulate-BookingTest.ps1 simulates booking test// [] TESTING: Test-DeskProvisioning.ps1 tests desk provisioning// [] TESTING: Test-MailboxSettings.ps1 tests mailbox settings// [] TESTING: Test-RoomProvisioning.ps1 tests room provisioning"]}]]