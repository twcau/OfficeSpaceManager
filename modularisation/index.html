<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.11.0.806689433749">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.11.0">

    <!-- Primary Meta Tags -->
    <title>PowerShell Project Modularisation Guide</title>
    <meta name="title" content="PowerShell Project Modularisation Guide">
    <meta name="description" content="0. Modularisation areas">

    <!-- Canonical -->
    <link rel="canonical" href="https://docs.example.com/modularisation/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://docs.example.com/modularisation/">
    <meta property="og:title" content="PowerShell Project Modularisation Guide">
    <meta property="og:description" content="0. Modularisation areas">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://docs.example.com/modularisation/">
    <meta property="twitter:title" content="PowerShell Project Modularisation Guide">
    <meta property="twitter:description" content="0. Modularisation areas">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link href="../resources/css/retype.css?v=3.11.0.806689433749" rel="stylesheet">

    <script data-cfasync="false" src="../resources/js/config.js?v=3.11.0.806689433749" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../resources/js/retype.js?v=3.11.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../resources/js/lunr.js?v=3.11.0.806689433749" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../resources/js/prism.js?v=3.11.0.806689433749" defer></script>
</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>
    
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">Project Name</span>
                        </a><span id="retype-branding-label" class="inline-flex mt-1 px-2 py-1 ml-4 text-xs font-medium leading-none items-center rounded-md bg-branding-label-bg text-branding-label-text ring-1 ring-branding-label-border ring-inset md:inline-block">Docs</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://retype.com/guides/getting-started/">Getting Started</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-search-placeholder transition-colors duration-200 ease-in bg-search-bg border border-transparent rounded md:text-sm hover:border-search-border-hover focus:outline-none focus:border-search-border-focus" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div id="retype-container" class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
            
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded shadow-none text-sm focus:outline-none focus:border-filter-border-focus" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://retype.com/guides/getting-started/">Getting Started</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="retype-markdown" id="retype-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="retype-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<!-- omit from toc -->
<doc-anchor-target id="powershell-project-modularisation-guide" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#powershell-project-modularisation-guide">#</doc-anchor-trigger>
        <span>PowerShell Project Modularisation Guide</span>
    </h1>
</doc-anchor-target>
<ul>
<li><doc-anchor-trigger to="#0-modularisation-areas">0. Modularisation areas</doc-anchor-trigger>
<ul>
<li><doc-anchor-trigger to="#oa-modularisation-plan">OA. Modularisation plan</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#ob-modularisation-question">OB. Modularisation question</doc-anchor-trigger></li>
</ul>
</li>
<li><doc-anchor-trigger to="#1-define-logical-areas-domains">1. Define Logical Areas (Domains)</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#2-proposed-folder-structure">2. Proposed Folder Structure</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#3-how-to-modularise">3. How to Modularise</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#4-example-logging-module">4. Example: Logging Module</doc-anchor-trigger>
<ul>
<li><doc-anchor-trigger to="#modulesloggingloggingpsm1">Modules/Logging/Logging.psm1</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#usage-in-another-script">Usage in another script</doc-anchor-trigger></li>
</ul>
</li>
<li><doc-anchor-trigger to="#5-refactoring-existing-scripts">5. Refactoring Existing Scripts</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#6-naming-and-documentation">6. Naming and Documentation</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#7-testing">7. Testing</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#8-automation">8. Automation</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#9-gitignore">9. .gitignore</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#10-summary-table">10. Summary Table</doc-anchor-trigger></li>
<li><doc-anchor-trigger to="#next-steps">Next Steps</doc-anchor-trigger></li>
</ul>
<doc-anchor-target id="0-modularisation-areas">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#0-modularisation-areas">#</doc-anchor-trigger>
        <span>0. Modularisation areas</span>
    </h2>
</doc-anchor-target>
<p>// NOTE - Modularisation</p>
<ul class="contains-task-list">
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> TODO: Logging (e.g., Write-Log, error handling)</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> TODO: Utilities (helper functions, shared logic)</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> TODO: CLI (menu rendering, prompts, CLI output)</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked="checked" /> TODO: SiteManagement (building, floor, site, desk management)</li>
<li class="task-list-item"><p><input disabled="disabled" type="checkbox" checked="checked" /> TODO: Configuration (import/export, backup/restore, validation)</p>
<blockquote>
<p>All Configuration .ps1 scripts now import and call the module version. No duplicate logic remains in scripts.</p>
</blockquote>
</li>
<li class="task-list-item"><p><input disabled="disabled" type="checkbox" checked="checked" /> TODO: UserManagement (user and permissions logic)</p>
<blockquote>
<p>Nothing was found needing user attention.</p>
</blockquote>
</li>
<li class="task-list-item"><p><input disabled="disabled" type="checkbox" checked="checked" /> TODO: Reporting (report and summary generation)</p>
<blockquote>
<p>All Configuration .ps1 scripts now import and call the module version. No duplicate logic remains in scripts.</p>
</blockquote>
</li>
</ul>
<doc-anchor-target id="oa-modularisation-plan">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#oa-modularisation-plan">#</doc-anchor-trigger>
        <span>OA. Modularisation plan</span>
    </h3>
</doc-anchor-target>
<ol>
<li>Identify all logging-related functions and scripts
For example - Locate all instances of Write-Log and any related logging/error handling functions (e.g., in Write-Log.ps1, Global-ErrorHandling.ps1, or similar).</li>
<li>Move these functions into Modules*
Consolidate all logging and error handling logic into this file.</li>
<li>Update <em>Logging</em>.psm1
Ensure it dot-sources *.ps1 and exports all public functions.</li>
<li>Update all scripts that use logging
Remove any direct dot-sourcing of the old scripts.
And where needed, Add Import-Module <em>.psm1 (or the correct relative path) at the top of scripts that use</em>.</li>
<li>Replace any duplicate or now-centralised logging function definitions.</li>
<li>Clean up
Remove the old *.ps1 and any other now-obsolete logging scripts after confirming all references are updated.</li>
<li>Test
Run scripts and flows that use * to ensure no regressions.</li>
</ol>
<doc-anchor-target id="ob-modularisation-question">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ob-modularisation-question">#</doc-anchor-trigger>
        <span>OB. Modularisation question</span>
    </h3>
</doc-anchor-target>
<p>Still sticking with the earlier Option 1, let&#x27;s move onto modularising X/ now, and ensuring that:</p>
<p>Proper clean-up is done, to ensure no duplicated code for anything migrated into a module is left anywhere across the project;
All required updates performed to scripts that ensure the modularised code works properly, and can be correctly called at the right point when used and needed;
Done in a way which doesn&#x27;t cause an operational or functional regression in the project, project functionality, codebase, or any other part which impacts what the code does.
You alert me to any concerns, and seek my input if needed - providing appropriate explaination, so an informed decision or choice can be taken before you proceed.
Provide, in raw, all progress and updates as you work through this. Do not make me ask for updates, make sure I can see exactly what you are working on and making progress towards.
Make sure that the resulting actions are appropriately documented, in a file along the lines of _README-Area-Migration.txt, similar to those files already in Shared/</p>
<hr>
<p>Please continue with the remaining folders (Configuration, OrphanFixer, EnvironmentSetup, Shared, and TestSuite) to ensure all scripts are updated for modular logging and error handling; remembering my earlier instructions on expcectations, behaviours, cleanliness, housekeeping, anti-regression, and notifying of any concerns before proceeding with a change.</p>
<hr>
<p>Thanks, and please proceed with final clean-up and validation of your actions.</p>
<hr>
<doc-anchor-target id="1-define-logical-areas-domains">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#1-define-logical-areas-domains">#</doc-anchor-trigger>
        <span>1. Define Logical Areas (Domains)</span>
    </h2>
</doc-anchor-target>
<p>Think about the main “areas” or “domains” of your project. For example:</p>
<ul>
<li><strong>Logging &amp; Utilities</strong>: Logging, error handling, helpers.</li>
<li><strong>CLI/Presentation</strong>: Menu rendering, user prompts, CLI output.</li>
<li><strong>Site Management</strong>: Building, floor, site, and desk management.</li>
<li><strong>Configuration</strong>: Import/export, backup/restore, validation.</li>
<li><strong>User Management</strong>: User and permissions handling.</li>
<li><strong>Reporting</strong>: Generating and displaying reports.</li>
</ul>
<hr>
<doc-anchor-target id="2-proposed-folder-structure">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#2-proposed-folder-structure">#</doc-anchor-trigger>
        <span>2. Proposed Folder Structure</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-none"><code v-pre class="language-none">OfficeSpaceManager/
│
├── Modules/
│   ├── Logging/
│   │   └── Logging.psm1
│   ├── Utilities/
│   │   └── Utilities.psm1
│   ├── CLI/
│   │   └── CLI.psm1
│   ├── SiteManagement/
│   │   └── SiteManagement.psm1
│   ├── Configuration/
│   │   └── Configuration.psm1
│   ├── UserManagement/
│   │   └── UserManagement.psm1
│   └── Reporting/
│       └── Reporting.psm1
│
├── Scripts/
│   └── (Entry-point scripts, e.g. Start-OfficeSpaceManager.ps1)
│
├── Shared/
│   └── (Shared scripts or data files)
│
├── Backups/
│
├── Tests/
│   └── (Pester or other test scripts)
│
└── .gitignore</code></pre>
</doc-codeblock></div>
<hr>
<doc-anchor-target id="3-how-to-modularise">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#3-how-to-modularise">#</doc-anchor-trigger>
        <span>3. How to Modularise</span>
    </h2>
</doc-anchor-target>
<ul>
<li><strong>Group related functions</strong> into <code v-pre>.psm1</code> module files (e.g., all logging functions in <code v-pre>Logging.psm1</code>).</li>
<li><strong>Export only public functions</strong> from each module (using <code v-pre>Export-ModuleMember</code>).</li>
<li><strong>Use <code v-pre>Import-Module</code></strong> in your entry-point scripts or in other modules as needed.</li>
<li><strong>Keep entry-point scripts</strong> (the ones users run directly) in the <code v-pre>Scripts/</code> folder. These scripts should mostly call functions from your modules.</li>
</ul>
<hr>
<doc-anchor-target id="4-example-logging-module">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#4-example-logging-module">#</doc-anchor-trigger>
        <span>4. Example: Logging Module</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="modulesloggingloggingpsm1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#modulesloggingloggingpsm1">#</doc-anchor-trigger>
        <span>Modules/Logging/Logging.psm1</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell">function Write-Log { ... }
function Get-LogLevel { ... }
Export-ModuleMember -Function Write-Log, Get-LogLevel</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="usage-in-another-script">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#usage-in-another-script">#</doc-anchor-trigger>
        <span>Usage in another script</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell">Import-Module &quot;$PSScriptRoot/../Modules/Logging/Logging.psm1&quot;
Write-Log -Message &quot;Hello&quot; -Level &quot;INFO&quot;</code></pre>
</doc-codeblock></div>
<hr>
<doc-anchor-target id="5-refactoring-existing-scripts">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#5-refactoring-existing-scripts">#</doc-anchor-trigger>
        <span>5. Refactoring Existing Scripts</span>
    </h2>
</doc-anchor-target>
<ul>
<li><strong>Move functions</strong> from your <code v-pre>.ps1</code> scripts into the appropriate <code v-pre>.psm1</code> module.</li>
<li><strong>Replace duplicate helpers</strong> with shared functions in <code v-pre>Utilities.psm1</code>.</li>
<li><strong>Update scripts</strong> to import and use these modules, rather than duplicating code.</li>
</ul>
<hr>
<doc-anchor-target id="6-naming-and-documentation">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#6-naming-and-documentation">#</doc-anchor-trigger>
        <span>6. Naming and Documentation</span>
    </h2>
</doc-anchor-target>
<ul>
<li><strong>Name modules and folders</strong> for their domain/purpose.</li>
<li><strong>Add comment-based help</strong> to each function for discoverability.</li>
<li><strong>Document module purpose</strong> at the top of each <code v-pre>.psm1</code>.</li>
</ul>
<hr>
<doc-anchor-target id="7-testing">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#7-testing">#</doc-anchor-trigger>
        <span>7. Testing</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Place Pester or other test scripts in the <code v-pre>Tests/</code> folder, mirroring your module structure.</li>
</ul>
<hr>
<doc-anchor-target id="8-automation">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#8-automation">#</doc-anchor-trigger>
        <span>8. Automation</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Consider a bootstrap script (e.g., <code v-pre>Scripts/Start-OfficeSpaceManager.ps1</code>) that imports all needed modules and starts the CLI or main workflow.</li>
</ul>
<hr>
<doc-anchor-target id="9-gitignore">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#9-gitignore">#</doc-anchor-trigger>
        <span>9. .gitignore</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Ensure <code v-pre>Backups/</code>, <code v-pre>*.zip</code>, and any secrets/configs are ignored.</li>
</ul>
<hr>
<doc-anchor-target id="10-summary-table">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#10-summary-table">#</doc-anchor-trigger>
        <span>10. Summary Table</span>
    </h2>
</doc-anchor-target>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Folder</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Modules/Logging</td>
<td>Logging, error handling</td>
</tr>
<tr>
<td>Modules/CLI</td>
<td>CLI menus, prompts, output formatting</td>
</tr>
<tr>
<td>Modules/SiteManagement</td>
<td>Building/floor/site/desk logic</td>
</tr>
<tr>
<td>Modules/Configuration</td>
<td>Import/export, backup/restore</td>
</tr>
<tr>
<td>Modules/UserManagement</td>
<td>User and permissions logic</td>
</tr>
<tr>
<td>Modules/Reporting</td>
<td>Reports and summaries</td>
</tr>
<tr>
<td>Modules/Utilities</td>
<td>Shared helpers</td>
</tr>
<tr>
<td>Scripts/</td>
<td>Entry-point scripts</td>
</tr>
<tr>
<td>Shared/</td>
<td>Shared data/scripts</td>
</tr>
<tr>
<td>Backups/</td>
<td>Backups (gitignored)</td>
</tr>
<tr>
<td>Tests/</td>
<td>Unit/integration tests</td>
</tr>
</tbody>
</table>
</div>
<hr>
<doc-anchor-target id="next-steps">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#next-steps">#</doc-anchor-trigger>
        <span>Next Steps</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Start by creating the <code v-pre>Modules/</code> structure and moving functions into logical <code v-pre>.psm1</code> files.</li>
<li>Update your entry scripts to use <code v-pre>Import-Module</code>.</li>
<li>Test each module in isolation, then as part of whatever.</li>
</ul>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer id="retype-content-footer" class="clear-both">
                            
                                <nav id="retype-nextprev" class="print:hidden flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../modules/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-base-text-muted">Previous</span>
                                                <span class="block mt-1">Office​Space​Manager Modules</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                                <div id="retype-footer-links" class="print:hidden">
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link-weight text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "PowerShell Project Modularisation Guide", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
